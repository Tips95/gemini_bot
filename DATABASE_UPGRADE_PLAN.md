# üìä –ü–ª–∞–Ω —É–ª—É—á—à–µ–Ω–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

## üéØ **–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ: SQLite**

### ‚úÖ **–ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è:**
- **–°—Ç–∞—Ä—Ç–∞ –ø—Ä–æ–µ–∫—Ç–∞** (–¥–æ 1000 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)
- **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è** –∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- **–ë—ã—Å—Ç—Ä–æ–≥–æ –¥–µ–ø–ª–æ—è** –Ω–∞ Timeweb Cloud
- **–ù–µ–±–æ–ª—å—à–∏—Ö –Ω–∞–≥—Ä—É–∑–æ–∫** (–¥–æ 100 –≥–µ–Ω–µ—Ä–∞—Ü–∏–π/–¥–µ–Ω—å)

### ‚ö†Ô∏è **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞:**
- **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å:** –º–∞–∫—Å–∏–º—É–º ~10,000 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** –º–µ–¥–ª–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –ø—Ä–∏ —Ä–æ—Å—Ç–µ –¥–∞–Ω–Ω—ã—Ö
- **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å:** —Ä–∏—Å–∫ –ø–æ—Ç–µ—Ä–∏ –¥–∞–Ω–Ω—ã—Ö
- **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ—Å—Ç—å:** —Ç–æ–ª—å–∫–æ 1 –∑–∞–ø–∏—Å—å –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ

## üöÄ **–ü–ª–∞–Ω –º–∏–≥—Ä–∞—Ü–∏–∏ –Ω–∞ PostgreSQL**

### **–≠—Ç–∞–ø 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ (1-2 –¥–Ω—è)**
```sql
-- –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü –≤ PostgreSQL
CREATE TABLE users (
    id SERIAL PRIMARY KEY,
    telegram_id BIGINT UNIQUE NOT NULL,
    username VARCHAR(255),
    first_name VARCHAR(255),
    last_name VARCHAR(255),
    language_code VARCHAR(10) DEFAULT 'ru',
    subscription_active BOOLEAN DEFAULT FALSE,
    subscription_plan VARCHAR(50),
    subscription_expires_at TIMESTAMP,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    last_activity TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- –ò–Ω–¥–µ–∫—Å—ã –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
CREATE INDEX idx_users_telegram_id ON users(telegram_id);
CREATE INDEX idx_users_subscription ON users(subscription_active, subscription_expires_at);
```

### **–≠—Ç–∞–ø 2: –ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö**
```python
# –°–∫—Ä–∏–ø—Ç –º–∏–≥—Ä–∞—Ü–∏–∏ SQLite -> PostgreSQL
import sqlite3
import psycopg2
from datetime import datetime

def migrate_database():
    # –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ SQLite
    sqlite_conn = sqlite3.connect('bot_subscriptions.db')
    sqlite_cursor = sqlite_conn.cursor()
    
    # –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ PostgreSQL
    pg_conn = psycopg2.connect(DATABASE_URL)
    pg_cursor = pg_conn.cursor()
    
    # –ú–∏–≥—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
    sqlite_cursor.execute('SELECT * FROM users')
    users = sqlite_cursor.fetchall()
    
    for user in users:
        pg_cursor.execute('''
            INSERT INTO users (telegram_id, username, first_name, last_name, 
                             language_code, subscription_active, subscription_plan, 
                             subscription_expires_at, created_at, updated_at, last_activity)
            VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)
        ''', user[1:])  # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º id (–∞–≤—Ç–æ–∏–Ω–∫—Ä–µ–º–µ–Ω—Ç)
    
    pg_conn.commit()
    print("‚úÖ Users migrated successfully")
```

### **–≠—Ç–∞–ø 3: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–¥–∞**
```python
# src/database/production_db.py (—É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç!)
# –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Å simple_db –Ω–∞ production_db

# –í bot_runner.py:
from src.database.production_db import db  # –í–º–µ—Å—Ç–æ simple_db

# –í app.py:
from src.database.production_db import db  # –í–º–µ—Å—Ç–æ simple_db
```

## üìà **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ PostgreSQL:**

### **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**
- ‚úÖ **–ò–Ω–¥–µ–∫—Å—ã** –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞
- ‚úÖ **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã** (–¥–æ 1000+ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ)
- ‚úÖ **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- ‚úÖ **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å:**
- ‚úÖ **ACID —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏** (–∞—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç—å)
- ‚úÖ **–†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- ‚úÖ **–†–µ–ø–ª–∏–∫–∞—Ü–∏—è** –¥–ª—è –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏
- ‚úÖ **–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ** –ø–æ—Å–ª–µ —Å–±–æ–µ–≤

### **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å:**
- ‚úÖ **–ú–∏–ª–ª–∏–æ–Ω—ã –∑–∞–ø–∏—Å–µ–π** –±–µ–∑ –ø—Ä–æ–±–ª–µ–º
- ‚úÖ **–ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ**
- ‚úÖ **–ü–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ** –±–æ–ª—å—à–∏—Ö —Ç–∞–±–ª–∏—Ü
- ‚úÖ **–ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è** –¥–ª—è –≤—ã—Å–æ–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏

## üéØ **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –≤—Ä–µ–º–µ–Ω–∏:**

### **–î–ª—è —Å—Ç–∞—Ä—Ç–∞ (0-1000 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π):**
- ‚úÖ **SQLite –ø–æ–¥—Ö–æ–¥–∏—Ç** –∏–¥–µ–∞–ª—å–Ω–æ
- ‚úÖ **–ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫** –±–µ–∑ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- ‚úÖ **–ù–∏–∑–∫–∏–µ –∑–∞—Ç—Ä–∞—Ç—ã** –Ω–∞ —Ö–æ—Å—Ç–∏–Ω–≥

### **–î–ª—è —Ä–æ—Å—Ç–∞ (1000-10000 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π):**
- ‚ö†Ô∏è **–ü–ª–∞–Ω–∏—Ä—É–π—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é** –Ω–∞ PostgreSQL
- ‚ö†Ô∏è **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏**
- ‚ö†Ô∏è **–†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ** SQLite

### **–î–ª—è –º–∞—Å—à—Ç–∞–±–∞ (10000+ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π):**
- üö® **–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ PostgreSQL**
- üö® **–ö–ª–∞—Å—Ç–µ—Ä –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö**
- üö® **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–ª–µ—Ä—Ç—ã**

## üí∞ **–°—Ç–æ–∏–º–æ—Å—Ç—å —Ö–æ—Å—Ç–∏–Ω–≥–∞:**

### **SQLite (—Ç–µ–∫—É—â–∏–π):**
- **Timeweb Cloud:** 0‚ÇΩ (–≤–∫–ª—é—á–µ–Ω–æ)
- **–ü—Ä–æ—Å—Ç–æ—Ç–∞:** –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è
- **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å:** –±–∞–∑–æ–≤–∞—è

### **PostgreSQL (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π):**
- **Timeweb Cloud:** ~500‚ÇΩ/–º–µ—Å—è—Ü
- **–ü—Ä–æ—Å—Ç–æ—Ç–∞:** —Å—Ä–µ–¥–Ω—è—è
- **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å:** –≤—ã—Å–æ–∫–∞—è

## üéØ **–ò—Ç–æ–≥–æ–≤–∞—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**

### **–î–ª—è –≤–∞—à–µ–≥–æ –±–æ—Ç–∞ –ü–†–Ø–ú–û –°–ï–ô–ß–ê–°:**
‚úÖ **SQLite –ø–æ–¥—Ö–æ–¥–∏—Ç –∏–¥–µ–∞–ª—å–Ω–æ!**

**–ü—Ä–∏—á–∏–Ω—ã:**
1. **–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç** - –∑–∞–ø—É—Å–∫ –∑–∞ 5 –º–∏–Ω—É—Ç
2. **–ù–∏–∑–∫–∏–µ –∑–∞—Ç—Ä–∞—Ç—ã** - 0‚ÇΩ –Ω–∞ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
3. **–ü—Ä–æ—Å—Ç–æ—Ç–∞** - –Ω–∏–∫–∞–∫–∏—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫
4. **–î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ** –¥–ª—è –ø–µ—Ä–≤—ã—Ö –º–µ—Å—è—Ü–µ–≤ —Ä–∞–±–æ—Ç—ã

### **–ö–æ–≥–¥–∞ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –Ω–∞ PostgreSQL:**
- üìä **1000+ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π**
- üìä **100+ –≥–µ–Ω–µ—Ä–∞—Ü–∏–π –≤ –¥–µ–Ω—å**
- üìä **–ü—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é**
- üìä **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**

## üöÄ **–ü–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π:**

1. **–°–ï–ô–ß–ê–°:** –î–µ–ø–ª–æ–π —Å SQLite ‚úÖ
2. **–ß–µ—Ä–µ–∑ –º–µ—Å—è—Ü:** –ê–Ω–∞–ª–∏–∑ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ üìä
3. **–ü—Ä–∏ —Ä–æ—Å—Ç–µ:** –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏ üìã
4. **–ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏:** –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ PostgreSQL üîÑ

**–í–∞—à –±–æ—Ç –≥–æ—Ç–æ–≤ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É —Å SQLite!** üéâ